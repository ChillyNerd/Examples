# Пример организации сервера с помощью FastAPI

## Цель проекта 

Организовать API с возможностью разделить отдельные роуты (эндпоинты) по файлам и возможностью настраивать порт и хост сервера с помощью конфигурационного файла 

## Системные требования

Python 3.10.3

Требуемые библиотеки описаны в `requirements.txt`

## Структура проекта

Сервер располагается в пакете app

В пакете app находятся:

* ApplicationServer в файле `app.py` - класс сервера, который хранит в себе обьект FastAPI, логгер, конфиг и общие для всех роутов методы требующие конфигурационные параметры
* AbstractApp в файле `abstract_app.py` - абстрактный класс сервера. Нужен для избегания цикличного импортирования при инициализации роутов, и для более явной типизации обьекта сервера передаваемого в метод init каждого файла роутов.
* Файл `defaults.py` хранит нетребующие конфигурации методы и переменные
* Файл `schemas.py` хранит определение DTO-шек для роутов
* Пакет `routes` хранит файлы с определением роутов
  * Каждый файл роутов должен иметь метод init, который должен принимать в качестве параметра AbstractApp. Через передаваемый параметр вызывается обьект FastAPI и затем уже определяется метод с декоратором роута (по примеру @source.app.post(...описание роута))
  * Метод init каждого файла роутов импортируется в __init__ пакета с названием начинающимся с init

Все роуты добавляются при выполнении метода init_routes в ApplicationServer.

## Примечания

* Сам сервер запускается с помощью uvicorn. Для этого надо в него передать ApplicationServer.app и хост с портом

## Пример конфигурационного файла `config.yaml`
<pre><code class="shell">log:
  level: DEBUG

app:
  host: Хост сервера (по умолчанию имя машины, на которой запускается скрипт)
  port: Порт, на котором сервер запускается (по умолчанию 80)
</code></pre>